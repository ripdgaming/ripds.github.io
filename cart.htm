<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <link rel="stylesheet" href="cart.css">
    <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.1.0/jquery.min.js"></script>
    <link rel="stylesheet" href="https://maxcdn.bootstrapcdn.com/font-awesome/4.7.0/css/font-awesome.min.css"></a>
    
    <title>Document</title>
</head>
<body>
    
    <nav>
        <input id="nav-toggle" type="checkbox">
        <div class="logo"><a href="product.htm">
          <img src="image/logo1.jpg" title="Rest In Peace Of Department">
        </a></div>
        <ul class="links">
          <li><a href="index.htm">HOME</a></li>
          <li><a href="product.htm">PRODUCT</a></li>
          <li><a href="contact.php">CONTACT</a></li>
          <li><a href="about.php">ABOUT&nbspUS</a></li>
        </ul>
        <a href="login.htm" class="fa fa-user" title="Login" style="font-size: 30px;"></a>
        <label for="nav-toggle" class="icon-burger">
          <div class="line"></div>
          <div class="line"></div>
          <div class="line"></div>
        </label>
      </nav>

<div class="bottom">
    <div class="white_bottom">
      <div class="left_side">
        <input class="mouseP" type="text"/>
        <div class="top_sq"></div>
        <div class="bottom_sq"></div>
        <div class="shoe">
          <div class="left_btn">❰</div>
          <div class="shoe_img"><img class="imgR" src="image/l1.png"/><img class="imgW" src="https://github.com/Lockingdong/Shopping-Cart/blob/master/shoeW.png?raw=true"/></div>
          <div class="right_btn">❱</div>
        </div>
        <div class="switch">
          <div class="switch1 th_shoe"></div>
          <div class="switch2"></div>
        </div>
        <div class="icon">
          <div class="back">
            <svg viewbox="0 2 50 50">
              <circle cx="25.906" cy="27.496" r="19.121"></circle>
              <polyline points="24.5,34.157 17.053,27.341 24.5,20.525 "></polyline>
              <line x1="17.053" y1="27.341" x2="35.237" y2="27.468"></line>
            </svg>
          </div>
          <div class="cart" id="cartIcon">
            <svg viewbox="0 0 50 50">
              <path d="M22.822,28.96"></path>
              <polyline points="15.289,18.241 17.591,18.528 21.689,30 30.228,30 32.208,22.262 18.891,22.325 "></polyline>
              <circle class="w" cx="28.472" cy="32.31" r="0.996"></circle>
              <circle class="w" cx="23.257" cy="32.31" r="0.996"></circle>
              <circle cx="24.804" cy="25.496" r="19.121"></circle>
            </svg>
            <div class="RTnumber"></div>
          </div>
        </div>
      </div>
      <div class="right_side">
        <div class="info">
          <div class="sname">&nbspSkate Shoes
            <div class="name">Roshe&nbsp<b>Walk</b></div>
          </div>
          <div class="price">NT$ 8,700</div>
        </div>
        <div class="deco">      </div>
        <div class="detail">
          <div class="qua">
            <div class="text">
              <div class="word">Quantity:&nbsp</div>
              <div class="count">1</div>
            </div>
            <div class="counter">
              <div class="sub">-</div>
              <div class="num">1</div>
              <div class="add">+</div>
            </div>
          </div>
          <div class="color">
            <div class="text">
              <div class="word">Color:&nbsp </div>
              <div class="this_color"></div>
            </div>
            <div class="color_group">
              <div class="c1">Maroon</div>
              <div class="c2">Ivory</div>
            </div>
          </div>
          <div class="size">
            <div class="text">
              <div class="this_size">Size:&nbsp</div>
              <div class="size_num"></div>
            </div>
            <ul>
              <li>7</li>
              <li>7.5</li>
              <li>8</li>
              <li>8.5</li>
              <li>9</li>
              <li>9.5</li>
              <li>10</li>
              <li>10.5  </li>
            </ul>
          </div>
        </div>
        <button id="addTOCart"> 
          <svg viewbox="0 0 50 50">
            <path d="M22.822,28.96"></path>
            <polyline points="15.289,18.241 17.591,18.528 21.689,30 30.228,30 32.208,22.262 18.891,22.325 "></polyline>
            <circle class="w" cx="28.472" cy="32.31" r="0.996"></circle>
            <circle class="w" cx="23.257" cy="32.31" r="0.996"></circle>
          </svg>
          <h1>Add to Cart</h1>
        </button>
      </div>
    </div>
    <div class="cart_bottom">
      <div class="cart_list">
        <div class="close_btn">✖</div>
        <div class="title">
          <div class="cart_icon"> 
            <svg viewbox="0 0 50 50">
              <path d="M22.822,28.96"></path>
              <polyline points="15.289,18.241 17.591,18.528 21.689,30 30.228,30 32.208,22.262 18.891,22.325 "></polyline>
              <circle class="w" cx="28.472" cy="32.31" r="0.996"></circle>
              <circle class="w" cx="23.257" cy="32.31" r="0.996"></circle>
            </svg>
          </div>
          <h2>Your Cart</h2>
        </div>
        <div class="list">
          <div class="cart_cat">
            <div class="desT">Description</div>
            <div class="colorT">Color</div>
            <div class="sizeT">size</div>
            <div class="QTYT">QTY</div>
            <div class="priceT">Price</div>
          </div>
          <ul></ul>
        </div>
        <div class="total">
          <div class="totalT">Total:</div>
          <div class="totalP">NT$ 21600</div>
        </div>
        <div class="checkout">
          <button class="cancel">Cancel</button>
          <button>Checkout</button>
        </div>
      </div>
    </div>
  </div>
  <div class="roomRec">
    <div class="recbottom"></div><img src=""/>
  </div>
  <div class="linkarea"><a href="https://www.facebook.com/dongfrontend/" target="_blank"><span class="fa fa-facebook-official"></span></a><a href="https://www.instagram.com/d0ngy1n/" target="_blank"><span class="fa fa-instagram"></span></a></div>
</body>
<script>
    $(".cart_list").click(function () {
    return false;
  });
  $(".close_btn, .cancel, .cart_bottom").click(function () {
    $(".cart_bottom").css({ display: "none" });
    $(".white_bottom").removeClass("blur");
  });
  $("#cartIcon").click(function () {
    $(".cart_bottom").css({ display: "flex" });
    $(".white_bottom").addClass("blur");
  });
  
  //----------add qty-----------
  var qty = 1;
  function AddandSub(obj, n) {
    $(obj).click(function () {
      if (n == -1) {
        qty <= 1 ? qty == 1 : (qty += n);
      } else {
        qty += n;
      }
      $(".num").text(qty);
      $(".count").text(qty);
    });
  }
  AddandSub(".add", 1);
  AddandSub(".sub", -1);
  
  //---------------select--------------------
  function Select_AddClass(group, text_obj, classN) {
    for (i = 0; i < $(group).length; i++) {
      $(group)
        .eq(i)
        .click(function () {
          $(group).removeClass(classN);
          var text;
          text = $(this).text();
          $(text_obj).text(text);
          $(this).addClass(classN);
          $(".RTnumber").removeClass("countScale");
        });
    }
  }
  //---------------selectColor--------------------
  Select_AddClass(".color_group div", ".this_color", "th");
  //---------------selectSize--------------------
  Select_AddClass(".size ul li", ".size_num", "th_size");
  
  //
  var d = new Date();
  var dd = d.getDate();
  var mm = d.getMonth() + 1;
  var yy = d.getFullYear();
  
  var buyListJson = {
    name: "myCart",
    item: [
      {
        src: "https://dl.dropbox.com/s/zj3p16de62wt8gv/shoeR.png?dl=0",
        i_name: "Roshe Walk",
        i_date: "2016-11-23",
        i_color: "Maroon",
        i_size: "8",
        i_QTY: "2",
        i_price: "17400"
      },
      {
        src: "https://dl.dropbox.com/s/shb10c7em9ja96v/shoeW.png?dl=0",
        i_name: "Roshe Walk",
        i_date: "2016-11-22",
        i_color: "Ivory",
        i_size: "8.5",
        i_QTY: "1",
        i_price: "8700"
      }
    ]
  };
  var myshoelink =
    "https://dl.dropbox.com/s/ciozu8rpd40bex8/shoeBuyList.txt?dl=0";
  $.ajax({
    url: myshoelink,
    success: function (data) {
      //alert();
      console.log(JSON.parse(data));
      buyListJson = JSON.parse(data);
  
      createList();
    }
  });
  
  var total = 0;
  var redsrc = "https://dl.dropbox.com/s/zj3p16de62wt8gv/shoeR.png?dl=0";
  var whitesrc = "https://dl.dropbox.com/s/shb10c7em9ja96v/shoeW.png?dl=0";
  var cartlist =
    "<li> <div class='i_des'> <div class='pimg'><img src={{img}}/></div> <div class='i_name'>{{i_name}}</div> <div class='i_date'>{{i_date}}</div> </div> <div class='i_color'>{{i_color}}</div> <div class='i_size'>{{i_size}}</div> <div class='i_QTY'>{{i_QTY}}</div> <div class='i_price'>NT$ {{i_price}}</div> <div class='i_remove'> <svg viewbox='0 0 100 100'> <g> <rect x='22' y='22' width='56' height='9'></rect> <rect x='39' y='18' width='22' height='4'></rect> <path d='M26,35v48h48V35H26z M39,74h-4V39h4V74z M52,74h-4V39h4V74z M66,74h-5V39h5V74z'></path> </g> </svg> </div> </li>";
  function createList() {
    total = 0;
    $(".list ul").html(""); //-----------clear OG list------------
    for (i = 0; i < buyListJson.item.length; i++) {
      $(".list ul").append(
        cartlist
          .replace("{{img}", buyListJson.item[i].src)
          .replace("{{i_name}}", buyListJson.item[i].i_name)
          .replace("{{i_date}}", buyListJson.item[i].i_date)
          .replace("{{i_color}}", buyListJson.item[i].i_color)
          .replace("{{i_size}}", buyListJson.item[i].i_size)
          .replace("{{i_QTY}}", buyListJson.item[i].i_QTY)
          .replace("{{i_price}}", buyListJson.item[i].i_price)
      );
  
      //-------------------add remove event-------------------------------
      $(".i_remove").eq(i).attr("deleteIndex", i); //---加屬性
  
      $(".i_remove")
        .eq(i)
        .click(function () {
          $(this).parent().animate({ left: "-300", opacity: "0" }, 500);
          console.log($(this).attr("deleteIndex"));
          buyListJson.item.splice($(this).attr("deleteIndex"), 1);
          //刪除陣列裡第this.deleteIndex個物件
          setTimeout(function () {
            createList();
          }, 500);
        });
  
      //-----------------------total price----------------------------------
  
      total += parseInt(buyListJson.item[i].i_price);
      //console.log(total)
      //console.log($('.totalP').text())
    }
    $(".totalP").text("NT$ " + total);
    //-----------------detect list amount------------------------
    if (buyListJson.item.length == 0) {
      $(".RTnumber").css({ display: "none" });
    } else {
      $(".RTnumber").css({ display: "block" });
      $(".RTnumber").text(buyListJson.item.length);
    }
  }
  createList();
  //-----------------------add to list----------------------------------------
  $("#addTOCart").click(function () {
    //--------------detect none color & size-----------------------
    if ($(".this_color").text() == "" || $(".size_num").text() == "") {
      alert("Please select the quantity, color and size.");
      return false;
    } else {
      //alert()
      //---------------detect shoe color----------------------------
      var thissrc = "";
      if ($(".this_color").text() == "Maroon") {
        thissrc = redsrc;
      } else {
        thissrc = whitesrc;
      }
      //-----------------------------------------
      buyListJson.item.unshift({
        src: thissrc,
        i_name: $(".info .name").text(),
        i_date: yy + "-" + mm + "-" + dd,
        i_color: $(".this_color").text(),
        i_size: $(".size_num").text(),
        i_QTY: $(".num").text(),
        i_price: 8700 * parseInt($(".num").text())
      });
      $(".RTnumber").addClass("countScale");
      createList();
    }
    //-------------removeClass--------------------------
    $(".color_group div").removeClass("th");
    $(".this_color").text("");
    $(".size ul li").removeClass("th_size");
    $(".size_num").text("");
    //----------------set qty to 1-----------------------
    qty = 1;
    $(".count").text(qty);
    $(".num").text(qty);
  });
  
  $(".imgW").css({ left: "-410px" });
  $(".imgR").css({ left: "0px" });
  //----------------------
  function switch_click(obj, dis1, dis2, Img) {
    $(obj).click(function () {
      $(".switch div").removeClass("th_shoe");
      $(this).addClass("th_shoe");
      $(".imgW").animate({ left: dis1 }, 500);
      $(".imgR").animate({ left: dis2 }, 500);
      roomImg(Img);
    });
  }
  switch_click(".switch2", "0px", "410px", ".imgW");
  switch_click(".switch1", "-410px", "0px", ".imgR");
  
  function trigger(obj, obj2) {
    $(obj).click(function () {
      $(obj2).trigger("click");
    });
  }
  trigger(".right_btn", ".switch2");
  trigger(".left_btn", ".switch1");
  trigger(".c1", ".switch1");
  trigger(".c2", ".switch2");
  
  $(".switch1").trigger("click");
  
  //----------------image room--------------------
  
  function roomImg(obj) {
    $(".roomRec img").css({
      width: parseInt($(".imgR").css("width")) * 3 + "px"
    });
    //放大原圖3倍
  
    $(".shoe_img img, .roomRec").mousemove(function (ev) {
      var scrollLeft =
        document.body.scrollLeft || document.documentElement.scrollLeft;
      var scrollTop =
        document.body.scrollTop || document.documentElement.scrollTop;
      //console.log(scrollTop)
  
      $(".roomRec").css({ display: "block" });
      var oEvent = ev || event;
      var X = scrollLeft + oEvent.clientX;
      var Y = scrollTop + oEvent.clientY;
      var recH = parseInt($(".roomRec").css("height"));
      //放大框的高
  
      $(".roomRec img").attr("src", $(this).attr("src"));
      //放大框內的IMG就是滑鼠指到的圖片
  
      $(".roomRec").css({ left: X + "px" });
      $(".roomRec").css({ top: Y - recH + "px" });
      //讓放大框的高能在滑鼠的右上角
  
      var imgL = Math.round(X - $(obj).offset().left);
      var imgT = Math.round(Y - $(obj).offset().top);
      //滑鼠在此張圖片上的位置
  
      $(".mouseP").val(imgL + " , " + imgT);
      $(".roomRec img").css({ left: -imgL * 3 + 60 + "px" });
      $(".roomRec img").css({ top: -imgT * 3 + 60 + "px" });
      //決定放大框內的圖片需要移動的位置
    });
    $(".shoe_img img").mouseleave(function () {
      $(".roomRec").css({ display: "none" });
    });
  }
  
</script>
</html>